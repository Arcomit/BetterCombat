# Better Combat

![Java 17](https://img.shields.io/badge/Java%2017-ee9258?logo=java&logoColor=ffffff&labelColor=606060&style=flat-square)
![Environment: Client & Server](https://img.shields.io/badge/environment-Client%20&%20Server-1976d2?style=flat-square)
[![Mod loader: Fabric]][fabric]
[![Discord](https://img.shields.io/discord/973561601519149057.svg?label=&logo=discord&logoColor=ffffff&color=7389D8&labelColor=6A7EC2&style=flat-square)](https://discord.gg/UTbHdnwK)

[fabric]: https://fabricmc.net
[Mod loader: Fabric]: https://img.shields.io/badge/modloader-Fabric-1976d2?style=flat-square&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFHGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE4LTEyLTE2VDE2OjU0OjE3LTA4OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wNy0yOFQyMToxNzo0OC0wNzowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOS0wNy0yOFQyMToxNzo0OC0wNzowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowZWRiMWMyYy1mZjhjLWU0NDEtOTMxZi00OTVkNGYxNGM3NjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MGVkYjFjMmMtZmY4Yy1lNDQxLTkzMWYtNDk1ZDRmMTRjNzYwIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6MGVkYjFjMmMtZmY4Yy1lNDQxLTkzMWYtNDk1ZDRmMTRjNzYwIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDowZWRiMWMyYy1mZjhjLWU0NDEtOTMxZi00OTVkNGYxNGM3NjAiIHN0RXZ0OndoZW49IjIwMTgtMTItMTZUMTY6NTQ6MTctMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE4IChXaW5kb3dzKSIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4/HiGMAAAAtUlEQVRYw+XXrQqAMBQF4D2P2eBL+QIG8RnEJFaNBjEum+0+zMQLtwwv+wV3ZzhhMDgfJ0wUSinxZUQWgKos1JP/AbD4OneIDyQPwCFniA+EJ4CaXm4TxAXCC0BNHgLhAdAnx9hC8PwGSRtAFVMQjF7cNTWED8B1cgwW20yfJgAvrssAsZ1cB3g/xckAxr6FmCDU5N6f488BrpCQ4rQBJkiMYh4ACmLzwOQF0CExinkCsvw7vgGikl+OotaKRwAAAABJRU5ErkJggg==

Easy, spectacular and fun melee combat system we know from Minecraft Dungeons.

Each weapon can have unique behaviour, by specifying weapon attributes via a JSON API.

# ‚≠êÔ∏è Features

Primary features:
- [X] Assign attributes to weapons via JSON API
- [ ] Define how the weapon is held (for example: `1H_SWORD`, `2H_SWORD`, etc...)
- [X] Define combos for the weapon (each attack in a combo can have different properties)
- [ ] Define swing animations and sounds for the weapon
- [X] Upswing weapon before hitting
- [X] Accurate hitbox calculation (based on [OBB](https://www.sciencedirect.com/topics/computer-science/oriented-bounding-box)+[SAT](https://en.wikipedia.org/wiki/Hyperplane_separation_theorem))
- [X] Hitting multiple enemies with a single strike
- [X] Weapon attributes are synchronized (server sends to client)
- [ ] Bundled resources: weapon animations, weapon sounds, weapon attribute presets

Auxiliary features:
- [X] Two-handed weapons ignore offhand slot
- [X] Attacking with dual wielded weapons (Server configurable)
- [X] Cancel attack during upswing (aka "feint") (Client configurable)
- [X] Hold attack key to spam attack (Client configurable)
- [X] Target in hitbox indication (Client configurable)
- [X] Swing thru grass (Client configurable)
- [X] Can disable mining with weapons (Client configurable)

Future plans:
- Conditional attacks inside combos (for example: `OFF_HAND_ONLY`, `MAIN_HAND_ONLY`, `REQURES_SAME_OFFHAND`)
- Rolling
- Additional weapon attributes (for example: movement penalty, pushback)
- Weapon trail animation while hitting 
- External weapon swing animations

# üî® Integrate your mod

Weapon attributes are the behaviour of a weapon including: range, combos (list of attacks), animations and sounds, etc...

Assign weapon attributes to weapons of your mod, just by creating **resource files**. This is done similar to how you assign crafting recipes to an item.
**No need for any java or gradle dependency**.

For example adding attributes to a custom sword named "Claymore" from your mod:
- mod id is `my-mod-id`
- item id of the Claymore is `my-mod-id:claymore`

To assign weapon attributes to the Claymore, create a new json file at the following location:

```resources/data/my-mod-id/weapon_attributes/claymore.json```

The content of this json file should be the following:

## Using a preset

Presets are a collection of weapon attributes bundled with this mod, covering the most common use cases.

Example for using the `bettercombat:claymore` for our Claymore:

```
{
  "parent": "bettercombat:claymore"
}
```

You can check out all available presets [here](https://github.com/ZsoltMolnarrr/BetterCombat/tree/main/src/main/resources/data/bettercombat/weapon_attributes).

You can make and reference your own presets the same way.

## Custom attributes

If you want custom behaviour for your weapon, you can create them from scratch.

When no parent is specified, the value for `"attributes"` key must be a full json object that can be parsed into [WeaponAttributes](https://github.com/ZsoltMolnarrr/BetterCombat/blob/main/src/main/java/net/bettercombat/api/WeaponAttributes.java) object.
```
{
  "attributes": { ... }
}
```

---

When parent is specified, you can partially override its properites:
```
{
  "parent": "bettercombat:claymore",
  "attributes": {
    "attackRange": 3.5
    "attacks": [
      {
        "angle" = 100
      },
      {
        "damageMultiplier" = 0.1 
      },
      {
        "damageMultiplier" = 0.3,
        "angle" = 90
      }
    ]
  }
}
```

---

You can create and use your own presets:
```
{
  "parent": "my-mod-id:longsword",
  "attributes": { ... }
}
```

# üîß Configuration

## Client

You can access the client side settings via the [Mod Menu](https://github.com/TerraformersMC/ModMenu).

## Server

Server config can be found at: `config/bettercombat/server.conf`

Automatically created with default values, upon loading any game world for the first time. 

# ‚õì Compatibility

This mod has been created in the spirit of maximal compatibility. However since some core mechanics are overridden, mods trying to change the same thing will never be compatible.